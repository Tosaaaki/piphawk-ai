DEFAULT_PAIR=USD_JPY
PIP_SIZE=0.01
TRADES_DB_PATH=backend/logs/trades.db

# --- テクニカル指標の期間 ---
RSI_PERIOD=14
EMA_PERIOD=20
ATR_PERIOD=14
BOLLINGER_WINDOW=20
BOLLINGER_STD=2

# --- フィルター条件しきい値 ---
RSI_ENTRY_LOWER=30
RSI_ENTRY_UPPER=70
ATR_ENTRY_THRESHOLD=0.04
BAND_WIDTH_THRESH_PIPS=3
EMA_DIFF_THRESHOLD=0.2
BB_POSITION_THRESHOLD=0.8

# --- TP/SL 初期設定（単位: pips）---
INIT_TP_PIPS=40
INIT_SL_PIPS=20
MIN_SL_PIPS=8
SHORT_TP_ATR_RATIO=0.6
TP_BB_RATIO=1.0

# --- その他設定 ---

# --- AI クールダウン（秒）---
AI_COOLDOWN_SEC_FLAT=30
AI_COOLDOWN_SEC_OPEN=60

# --- ロット制限 (1 lot = 100 00 units) ---
MIN_TRADE_LOT=30.0
MAX_TRADE_LOT=30.0
SCALE_LOT_SIZE=0.5
SL_COOLDOWN_SEC=300

# ローソク足の粒度（OANDA のフォーマット）
CANDLE_GRANULARITY=M5
TRADE_TIMEFRAMES=M1:20,M5:50,M15:50,H1:120,H4:90,D:90

RSI_EXIT_LOWER=30
RSI_EXIT_UPPER=70
ATR_EXIT_THRESHOLD=0.06

DISABLE_ENTRY_FILTER=false
DISABLE_EXIT_FILTER=true

EMA_FAST_PERIOD=9
EMA_SLOW_PERIOD=21

TRAIL_ENABLED=true
TRAIL_TRIGGER_PIPS=22
TRAIL_DISTANCE_PIPS=6

TRAIL_TRIGGER_MULTIPLIER=1.5
TRAIL_DISTANCE_MULTIPLIER=1.0

# --- 部分決済設定 ---
PARTIAL_CLOSE_PIPS=20
PARTIAL_CLOSE_RATIO=0.5


POSITION_REVIEW_ENABLED=true
POSITION_REVIEW_SEC=120

# --- ブレイクイーブン設定 ---
BE_TRIGGER_PIPS=5
BE_ATR_TRIGGER_MULT=0.5
BE_TRIGGER_R=0.5
BE_VOL_ADX_MIN=30
BE_VOL_SL_MULT=2.0

# 早期撤退ロジック ON/OFF
EARLY_EXIT_ENABLED=true

# 建値付近とみなす許容バッファ (pips)
BREAKEVEN_BUFFER_PIPS=2
# 早期撤退を行う際の最低利益幅(pips)
MIN_EARLY_EXIT_PROFIT_PIPS=5

# If the AI plan has no sl_pips, use latest M5 ATR × ATR_SL_MULTIPLIER
ATR_SL_MULTIPLIER=3.0
NOISE_SL_MULT=1.0
# ATRベースTP/SL倍率
ATR_MULT_TP=0.8
ATR_MULT_SL=1.1

# Overshoot block threshold multiplier (ATR × MULT)
OVERSHOOT_ATR_MULT=1.0

# AIに利益確定を問い合わせる閾値（TP目標の何割以上で問い合わせるか）
AI_PROFIT_TRIGGER_RATIO=0.5
MIN_RRR=1.5
ENFORCE_RRR=false

# AI判断を使った利益確定ロジックのON/OFF
AI_PROFIT_DECISION_ENABLED=true
# 停滞判定が有効なときの保有時間 (秒)
STAGNANT_EXIT_SEC=0
# ATR がこの値(pips)以下なら停滞とみなす
STAGNANT_ATR_PIPS=0
REVERSAL_EXIT_ATR_MULT=0.8
REVERSAL_EXIT_ADX_MIN=22
REVERSAL_RSI_DIFF=15
POLARITY_EXIT_THRESHOLD=0.4

# --- TP extension settings ---
TP_EXTENSION_ENABLED=true
TP_EXTENSION_ADX_MIN=25
TP_EXTENSION_ATR_MULT=1.0

# --- TP reduction settings ---
TP_REDUCTION_ENABLED=false
TP_REDUCTION_ADX_MAX=20
TP_REDUCTION_MIN_SEC=900
TP_REDUCTION_ATR_MULT=1.0

# --- OpenAI model selection ---
AI_REGIME_MODEL=gpt-4.1-nano
AI_ENTRY_MODEL=gpt-4.1-nano
AI_EXIT_MODEL=gpt-4.1-nano

# --- Chart pattern detection ---
PATTERN_NAMES=double_bottom,double_top,doji,hammer,bullish_engulfing,bearish_engulfing,morning_star,evening_star
PATTERN_MIN_BARS=5
PATTERN_TOLERANCE=0.005
PATTERN_TFS=M1,M5

# --- ボリューム関連 ---
VOL_MA_PERIOD=10
MIN_VOL_MA=80
MIN_VOL_M1=60

# --- 時間帯フィルター (JST) ---
QUIET_START_HOUR_JST=4
QUIET_END_HOUR_JST=7
QUIET2_START_HOUR_JST=23
QUIET2_END_HOUR_JST=1
QUIET2_ENABLED=false

# AI exit-override
ALLOW_AI_EXIT_OVERRIDE=true
AI_EXIT_CONF_THRESH=0.6
EXIT_BIAS_FACTOR=1.0

# 高位足（日足・4H）レベル計算のON/OFF
HIGHER_TF_ENABLED=true

# Entry cooldown period (seconds) after a position close during which new entries are skipped
ENTRY_COOLDOWN_SEC=60
# Exit check interval for periodic AI exit decision (seconds)
EXIT_CHECK_SEC=60
# ポジションを保持する最低秒数
MIN_HOLD_SEC=60

INVERT_ENTRY_SIDE=false
PEAK_ENTRY_ENABLED=true

# --- AI TP/SL フィルター ---
MIN_TP_PROB=0.8
# TP到達確率しきい値（0–1）
TP_PROB_HOURS=1

# --- Unified AI trade model ---
AI_TRADE_MODEL=gpt-4.1-nano
AI_LIMIT_CONVERT_MODEL=gpt-4.1-nano

# --- Limit‑order parameters ---
# ATR 比による指値エントリー閾値（0.3 = 30% ATR 以上の乖離で指値に切替）
LIMIT_THRESHOLD_ATR_RATIO=0.2

# 指値が未約定のまま見直す最大秒数（経過で再評価 or キャンセル）
MAX_LIMIT_AGE_SEC=600
PENDING_GRACE_MIN=3

# 指値価格の再調整回数の上限
MAX_LIMIT_RETRY=3

# Market-entry pullback offset (pips)
PULLBACK_LIMIT_OFFSET_PIPS=1
PULLBACK_PIPS=3
# Maximum allowed spread (pips) before switching to LIMIT entry
MAX_SPREAD_PIPS=1.2

# スプレッド控除後に必要な最小 TP 幅（pips）
MIN_NET_TP_PIPS=1

# --- クールダウン設定 ---
# ボリンジャーバンド幅比とATR比
COOL_BBWIDTH_PCT=0
COOL_ATR_PCT=0

# --- ADXノートレードゾーン ---
# ADXノートレードゾーンを無効化する場合は 0 を設定
ADX_NO_TRADE_MIN=0
ADX_NO_TRADE_MAX=0
# ADX value used to judge range conditions for entry filters
ADX_RANGE_THRESHOLD=25
ADX_SLOPE_LOOKBACK=3
ADX_DYNAMIC_COEFF=0
ENABLE_RANGE_ENTRY=true

# BB中央付近ブロック比（レンジ時）
RANGE_CENTER_BLOCK_PCT=0.15
# ボリンジャーバンド中心から何pips離れていればMarketエントリーを維持するか
RANGE_ENTRY_OFFSET_PIPS=3.5
# 日足ピボット付近のエントリー抑制幅 (pips)
PIVOT_SUPPRESSION_PIPS=15
# 抑制対象タイムフレーム (例: D,H4,H1)
PIVOT_SUPPRESSION_TFS=
FOLLOW_PULLBACK_ATR_RATIO=0.5

# 逆張り抑制設定
BLOCK_COUNTER_TREND=true
BLOCK_ADX_MIN=25

# クライマックスモード
CLIMAX_ENABLED=true
CLIMAX_ZSCORE=1.5
CLIMAX_TP_PIPS=7
CLIMAX_SL_PIPS=10

# Multi-timeframe EMA weights
TF_EMA_WEIGHTS=M5:0.4,H1:0.3,H4:0.3

# マルチTF整合が取れない場合にエントリーを見送るかどうか
STRICT_TF_ALIGN=false

USE_LOCAL_PATTERN=true
LOCAL_WEIGHT_THRESHOLD=0.3
PATTERN_EXCLUDE_TFS=M1
STRICT_ENTRY_FILTER=false
ALLOW_DELAYED_ENTRY=false

# --- 追加環境変数 ---
AI_MODEL=gpt-4.1-nano
AI_PATTERN_MODEL=gpt-4.1-nano
AI_PATTERN_MAX_TOKENS=256
AI_REGIME_COOLDOWN_SEC=60
API_PORT=8080
ATR_RATIO=1.8
CALENDAR_TRAIL_MULTIPLIER=1.5
CALENDAR_VOLATILITY_LEVEL=0
CALENDAR_VOL_THRESHOLD=3
CONSISTENCY_WEIGHTS=ema:0.4,adx:0.3,rsi:0.3
FALSE_BREAK_LOOKBACK=5
FALSE_BREAK_RATIO=0.5
FOLLOW_ADX_MIN=25
LINE_CHANNEL_TOKEN=
LINE_USER_ID=
LOG_LEVEL=INFO
MACD_FAST_PERIOD=12
MACD_SIGNAL_PERIOD=9
MACD_SLOW_PERIOD=26
MARGIN_WARNING_THRESHOLD=0
MIN_ATR_MULT=1.0
NO_TRADE=
OANDA_ACCOUNT_ID=
OANDA_API_KEY=
OANDA_API_URL=https://api-fxtrade.oanda.com/v3
OANDA_MATCH_SEC=60
OPENAI_API_KEY=
PEAK_EXIT_ENABLED=false
PEAK_EXIT_RETRACE_PIPS=2
PIP_VALUE_JPY=100
POLARITY_PERIOD=10
PULLBACK_ATR_RATIO=0.5
REENTRY_TRIGGER_PIPS=1
REV_BLOCK_BARS=3
RSI_CROSS_LOOKBACK=1
RSI_OVERBOUGHT_BLOCK=65
RSI_OVERSOLD_BLOCK=35
TAIL_RATIO_BLOCK=2.0
TRADE_LOT_SIZE=1.0
USE_INCOMPLETE_BARS=false
VOL_SPIKE_PERIOD=5
